# =============================================================================
# lorom256k.cfg — ca65/ld65 Linker Configuration for 256KB LoROM
# =============================================================================
# LoROM mapping: ROM at $008000-$00FFFF per bank
# 4 banks × 32KB = 128KB usable + mirrored = 256KB ROM
# =============================================================================

MEMORY {
    # Zero page: $00-$FF (direct page, fast access)
    ZP:         start = $00,     size = $100,    type = rw, file = "";

    # Stack + BSS in low WRAM
    # Loram used for stack ($0100-$1FFF) and variables ($0200+)
    LORAM:      start = $0200,   size = $1E00,   type = rw, file = "";

    # Hardware stack
    STACK:      start = $0100,   size = $0100,   type = rw, file = "";

    # ROM Bank 0: $008000-$00FFFF (32KB)
    ROM0:       start = $8000,   size = $8000,   type = ro, file = %O, fill = yes, fillval = $00;

    # ROM Bank 1: $018000-$01FFFF (32KB)
    ROM1:       start = $8000,   size = $8000,   type = ro, file = %O, fill = yes, fillval = $00;

    # ROM Bank 2: $028000-$02FFFF (32KB)
    ROM2:       start = $8000,   size = $8000,   type = ro, file = %O, fill = yes, fillval = $00;

    # ROM Bank 3: $038000-$03FFFF (32KB)
    ROM3:       start = $8000,   size = $8000,   type = ro, file = %O, fill = yes, fillval = $00;
}

SEGMENTS {
    # Zero page variables
    ZEROPAGE:   load = ZP,      type = zp;

    # BSS (uninitialized RAM variables)
    BSS:        load = LORAM,   type = bss;

    # Main code — bank 0
    CODE:       load = ROM0,    type = ro;

    # Read-only data — bank 0 (after code)
    RODATA:     load = ROM0,    type = ro;

    # ROM header at $00FFC0 (offset $7FC0 in bank 0)
    HEADER:     load = ROM0,    type = ro,  start = $FFC0;

    # Vector table at $00FFE0 (native mode) and $00FFF0 (emulation mode)
    VECTORS:    load = ROM0,    type = ro,  start = $FFE0;

    # Extra code/data banks
    BANK1:      load = ROM1,    type = ro,  optional = yes;
    BANK2:      load = ROM2,    type = ro,  optional = yes;
    BANK3:      load = ROM3,    type = ro,  optional = yes;
}
